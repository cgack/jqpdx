<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="generator" content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39">
        <meta charset="utf-8">
        <title>
            jQuery PDX
        </title>
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/beige.css" id="theme"><!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css"><!-- If the query includes 'print-pdf', use the PDF print sheet -->

        <script>
document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script><!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="reveal">
            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section>
                    <h2>
                        Dealing with the Natives:
                    </h2>
                    <h3>
                        jQuery Mobile &amp; Phonegap
                    </h3>
                    <p>
                        Cory Gackenheimer | @cgack
                    </p>
                </section>
                <section>
                    <section>
                        <h2>
                            About Me
                        </h2>
                        <ul>
                            <li>Work @healthx <span class='fragment'>jQuery Mobile + PhoneGap</span>
                            </li>
                            <li class='fragment'>Contribute to open source
                            </li>
                            <li class='fragment'>I write some 
                                <ul>
                                    <li class='fragment'>jQuery Mobile Cookbook
                                    </li>
                                    <li class='fragment'>Node.js Recipes
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <h2>
                            About this talk
                        </h2>
                        <p>
                            Producing a jQuery Mobile application with PhoneGap destined for Native stores
                        </p>
                        <ul>
                            <li class='fragment'>Native device features integration
                            </li>
                            <li class='fragment'>Phonegap plugins - push notifications
                            </li>
                            <li class='fragment'>Remote debugging madness
                            </li>
                            <li class='fragment'>My questionable Objective-C code
                            </li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>
                            Why target natives?
                        </h2><!-- <p class='fragment'>My boss told me to</p> -->
                        <p>
                            &nbsp;
                        </p>
                    </section>
                    <section>
                        <h3>
                            Because...<br>
                        </h3>
                        <ul>
                            <p class='fragment'>Presence in a native store can be valuable
                            </p>
                            <p class='fragment'>
                                <marquee><strong>$ $ $ $ $</strong></marquee>
                            </p>
                            <p class='fragment'>Device feature integration. More than a webview
                            </p>
                            <p class='fragment'>Small teams of Web Developers can handle it</p>
                        </ul>
                    </section>
                    <!-- <section>
                        <h3>
                            or to aggrevate all your users
                        </h3><img class='fragment' src='http://imgs.xkcd.com/comics/app.png'>
                    </section> -->
                </section>
                <section>
                    <section>
                        <h2>
                            on to jQuery Mobile and PhoneGap
                        </h2>
                        <p class='fragment'>... but first, a quick survey... </p>
                        <p class='fragment'>
                            Who has a native mobile application for themselves or their company?
                        </p>
                        <p class='fragment'>
                            Who targets multiple natives (iOS, Android, BB, Windows Phone, Others)?
                        </p>
                        <p class='fragment'>
                            Who uses PhoneGap or some other similar hybrid solution?
                        </p>
                    </section>
                    <section>
                        <h2>
                            PhoneGap in a nutshell
                        </h2>
                        <ul>
                            <p class='fragment'>Write your application in HTML, CSS, &amp; JavaScript
                            </p>
                            <p class='fragment'>PhoneGap bridges the native device features and exposes them to your application JavaScript
                            </p>
                            <p class='fragment'>You easily implement native features in your web app.
                            </p>
                        </ul>
                    </section>
                    <section>
                        <h2>
                            The Future
                        </h2>
                        <p class='fragment'>
                            PhoneGap becomes less important! 
                        </p>
                        <p class='fragment'>
                            No Really, this is a good thing.
                        </p>
                    </section>
                </section>
                <section>
                    <section>
                        <h3>
                            Why jQuery Mobile
                        </h3>
                        <p class='fragment'>
                            First, if you use jQuery and you want to build a mobile web app - use jQuery Mobile. 
                        </p>
                        <p class='fragment'>
                            so comfortable.
                        </p>
                        <p class='fragment'>
                            Cross-device, cross-browser, cross-platform compatiblity is rediculamazing!
                        </p>
                    </section>
                    <section>
                        <img src='gbs.png'>
                    </section>
                    <section>
                        <h2>
                            Authoring is easy
                        </h2>
                    </section>
                    <section>
<pre>
<code>
&lt;ul data-role="listview" data-inset="true"&gt;
    &lt;li&gt;&lt;a href="#"&gt;Acura&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;Audi&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;BMW&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;Cadillac&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;Ferrari&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

</code>
</pre>

                        <img src='listview.png'>
                    </section>
                    <section>
                        <h2>
                            Custom Themes
                        </h2>
                        <p>
                            ThemeRoller allows you to fit your brand
                        </p>
                    </section>
                    <section>
                        <h2>
                            for better or worse
                        </h2><img src='reg_jqm.png'> <img class='fragment' src='crazy_jqm.png'>
                    </section>
                    <section>
                        <h2>
                            Flat UI
                        </h2>
                        <p>There are many examples of flat UIs you can find on github or bitbucket.</p>
                        <img src='flatui.png' />
                    </section>
                    <section>
                        <h2>
                            BB10 Theme
                        </h2>
                        <p>
                            The team at Blackberry has built a custom theme to match the look and feel of the Blackberry 10 experience with custom colors and widgets
                        </p>
                    </section>
                    <section>
                        <h2>
                            speaking of widgets
                        </h2>
                        <p>
                            $.widget might be one of my favorite things
                        </p>
                            <p class='fragment'>powers jQuery UI widgets
                            </p>
                            <p class='fragment'>easily extended
                            </p>
                            <p class='fragment'>keeps plugins neat
                            </p>
                    </section>
                    <section>
                        <h2>
                            hx.card
                        </h2>
                        <p>
                            a custom widget to work on jQuery UI &amp;&amp; jQuery Mobile with one set of source code
                        </p>
                        <pre>
<code>
(function( $, undefined) {
    $.widget("mobile.card",...
    </code>
</pre>
                    </section>
                    <section>
                        <h2>
                            One set of markup
                        </h2>
                        <pre>
<code>
&lt;div data-role="card"&gt;
    &lt;span data-role="name"&gt;Frodo Baggins&lt;/span&gt;
    &lt;h1&gt;Go Paperless&lt;/h1&gt;
    &lt;h2&gt;Did you know...&lt;/h2&gt;
    &lt;p&gt;This is extra text that will likely show up on the card&lt;/p&gt;
    &lt;div data-role="icon" data-icon-name="lab"&gt;&lt;/div&gt;
&lt;/div&gt;
                        </code>
</pre>
                    </section>
                    <section>
                        <img src='card_mobile.png'>
                    </section>
                    <section>
                        <img src='card_full.png'>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>
                            Integrating native features
                        </h2>
                        <p>download phonegap
                        </p>
                        <p>set it up via the docs
                        </p>
                        <p>include cordova-X.X.X.js in your source
                        </p>
                        <p>sit back and relax...
                        </p>
                    </section>
                    <section>
                        <h2>
                            photo capture and upload
                        </h2>
                        <p>
                            First you need to make sure that phonegap has initialized then you can hook into the camera
                        </p>
                        <pre>
<code>
    // ready or not                        
    $(document).on('deviceready', function() { 
        /*... I can haz camera */
        if (typeof navigator.camera !== 'undefined') {
            // 
        }
    });
                        </code>
</pre>
                    </section>
                    <section>
                        <h2>
                            camera options
                        </h2>
                        <pre>
<code>
        var cameraOptions = {
            destinationType: Camera.DestinationType.FILE_URI,
            sourceType: Camera.PictureSourceType.CAMERA,
            allowEdit: true,
            encodingType: Camera.EncodingType.JPG,
            saveToPhotoAlbum: false
        };

                        </code>
</pre>
                    </section>
                    <section>
                        <h2>
                            get the picture
                        </h2>
                        <pre>
<code>
    navigator.camera.getPicture(success,fail,cameraOptions);
                        </code>
</pre>
                        <p>
                            success will provide the fileURI which we can then use to upload the file to the server
                        </p>
                    </section>
                    <section>
                        <h2>
                            File Upload
                        </h2>
                        <pre>
<code>
        var options = new FileUploadOptions();
        options.fileKey = 'file';
        options.fileName = newFileName;
        options.mimeType = 'image/jpeg';
        options.chunkedMode = false;
        options.params = {};
        
        var fileTransfer = new FileTransfer();
        fileTransfer.upload(this.imageUri, 
                            encodeURI(url), 
                            success, 
                            error, options);
    
                        </code>
</pre>
                    </section>
                    <section>
                        <h2>
                            add to jQuery Mobile
                        </h2><img height='30%' width='30%' src='upload.png'>
                    </section>
                    <section>
                        <ul>
                            <li>Accelerometer
                            </li>
                            <li>Camera
                            </li>
                            <li>Capture
                            </li>
                            <li>Compass
                            </li>
                            <li>Connection
                            </li>
                            <li>Contacts
                            </li>
                            <li>Device
                            </li>
                            <li>Events
                            </li>
                            <li>File
                            </li>
                            <li>Geolocation
                            </li>
                            <li>Globalization
                            </li>
                            <li>InAppBrowser
                            </li>
                            <li>Media
                            </li>
                            <li>Notification
                            </li>
                            <li>Splashscreen
                            </li>
                            <li>Storage
                            </li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Push Notifications</h2>
                        <p>Use PhoneGap plugins for cross-platform pushes</p>
                        <ul>
                            <li class='fragment'>Several services</li>
                            <li class='fragment'>A couple I've tried <ul>
                                <li class='fragment'>Pushwoosh</li>
                                <li class='fragment'>UrbanAirship<span class='fragment'>*</span></li>
                            </ul></li>
                        </ul>
                        <p class='fragment'>*This is what I currently use</p>
                    </section>
                    <section>
                        <h2>Prepare to Push</h2>
                        <ul>
                            <li>Enable Push for your platforms</li>
                            <li>Link your pushable app to Urban Airship</li>
                            <li>Get the plugin into your PhoneGap setup</li>
                            <li>Get Push code into your jQuery Mobile App</li>
                        </ul>
                    </section>
                    <section>
                        <h2>Enabling push for your platform</h2>
                        <ul>
                            <li class='fragment'>This can be involved but not difficult
                            <li class='fragment'>Basically you need to tell the vendor (Apple, Google, etc)
                                that you want to push to your app</li>
                            <li class='fragment'>They will provide an identification mechanism so that they can send messages from their servers to your users
                            <li class='fragment'>You tell Urban Airship this key and they will route the push to your devices
                        </ul>
                    </section>
                    <section>
                        <h2>Integrating into your project</h2>
                        <ul>iOS
                            <li class='fragment'>Add the push classes to your project 
                                <ul>
                                    <li>PushNotificationPlugin</li>
                                    <li>UAAppDelegateSurrogate</li>
                                </ul>
                            </li>
                            <li class='fragment'>Add a reference in your cordova.plist file so PhoneGap knows to use these new classes
                            <li class='fragment'>Whitelist *.urbanairship.com so you can actually talk to the servers
                            <li class='fragment'>download and install libUAirship into your xcode frameworks directory
                            <li class='fragment'>Add required sources for linking the project at build time
                            <li class='fragment'>Setup AirshipConfig.plist with UrbanAirship key and secret
                        </ul>

                    </section>
                    <section>
                        <h2>Gotchas</h2>
                        <ul>
                            <li class='fragment'>Development push versus production push
                            <li class='fragment'>Developer Provisioning on devices manually loaded.... use Dev
                            <li class='fragment'>AdHoc deployment on something like TestFlight?.... production required
                    </section>
                    <section>
                        <h2>Enabling Push for your platform</h2>
                        <ul>Android
                            <li class='fragment'>Install urbanairship-lib-x.x.x.jar
                            <li class='fragment'>Include PushNotificationPlugin.java 
                            <li class='fragment'>IntentReceiver.java
                            <li class='fragment'>Update AndroidManifest.xml to configure for UrbanAirship permissions
                        </ul>
                    </section>
                    <section>
                        <h2>Initialize Airship</h2>
                        <pre><code>
//INSIDE OF MainApplication.java                            
@Override
public void onCreate() {
    super.onCreate();
    UAirship.takeOff(this);
    PushManager.enablePush();
    PushManager.shared().setIntentReceiver(IntentReceiver.class)
}

public void onStop() {
    UAirship.land();
}
                        </code></pre>
                    </section>
                    <section>
                        <h2>Initialize Airship</h2>
                        <pre><code>
//in your main activity .java
@Override
public void onStart() {
    super.onStart();
    UAirship.shared().getAnalytics().activityStarted(this);
}
@Override
public void onStop() {
    super.onStop();
    UAirship.shared().getAnalytics().activityStopped(this);
}
                        </code></pre>
                    </section>
                    <section>
                        <h2>Using push in your JavaScript</h2>
                        <p>First, you need to make sure you have the PushNotification.js file in your project which serves as the bridge just like PhoneGap's cordova.js does for the device features</p>
                    </section>
                    <section>
                        <h2>Register for a push, create segments</h2>
                        <pre><code>
push = window.pushNotification;
push.registerForNotificationTypes(push.notificationType.sound | 
                                  push.notificationType.alert | 
                                  push.notificationType.badge);

push.registerEvent("registration", function () {
    push.setAlias(healthx.userId, function () {
        // alias set
    });

    push.setTags([healthx.siteid], function () {
        // grouped by site
    });
});
                        </code></pre>
                    </section>
                    <section>
                        <h2>Enabler</h2>     
                        <pre><code>
push = window.pushNotification;                            
push.enablePush();


push.isPushEnabled(function (enabled) {
    if (enabled) {
        push.setAlias(healthx.userId, function () {
           // alias set 
        });
    }
});                    
                        </code></pre>
                    </section>
                    <section>
                        <h2>Now push</h2>
                        <p> You can do this via the web console, or via the API...
                        <pre><code>
curl -X POST -u "<appkey>:<mastersecret>" -H "Content-Type: application/json" 
--data '{"tags": ["<tag>"],"android": { "alert": "tag api push" }}' 
                        </code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Remote Debugging</h2>
                    </section>
                    <section>
                            <h2>less than great methods</h2>
                        <ul>
                            <li class='fragment'>alert('here');
                            <li class='fragment'>Xcode console
                            <li class='fragment'>logcat in Eclipse/Android Dev Toolkit
                        </ul>
                    </section>
                    <section>
                        <h2>Modern Browser Remote Debugging</h2>
                        <ul>
                            <li><del>Opera Dragonfly</del>*
                            <li>Opera
                            <li>Chrome
                            <li>Firefox
                        </ul>
                        <p class='fragment'>* Dragonfly is still available in Opera, but Opera.next moves to Blink,
                            and to new dev tools. Remote debugging now mirrors that of the Chrome Dev Tools</p>
                    </section>
                    <section>
                        <h2>Opera</h2>
                        <ul>
                            <li class='fragment'>Enable remote debugging on your device.
                            <li class='fragment'>on your device, in opera navigate to opera:debug
                            <li class='fragment'>adb forward tcp:9222 localabstract:opera_devtools_remote
                            <li class='fragment'>Navigate to a chromium-based browser localhost:9222 to debug
                        <ul>
                    </section>
                    <section>
                        <h2>Chrome</h2>
                        <ul>
                            <li class='fragment'>Enable remote debugging on your device.
                            <li class='fragment'>on your device, in Chrome settings -> Enable USB Debugging
                            <li class='fragment'>adb forward tcp:9222 localabstract:chrome_devtools_remote
                            <li class='fragment'>Navigate to a chromium-based browser localhost:9222 to debug
                        <ul>
                    </section> 
                    <section>
                        <h2>Firefox</h2>
                        <ul>
                            <li class='fragment'>Enable remote debugging on your device
                            <li class='fragment'>In about:config on Firefox for Android<ul>
                                <li class='fragment'>devtools.debugger.force-local set to false
                                <li class='fragment'>devtools.debugger.remote-enabled set to true
                                </ul>
                            </li>
                            <li class='fragment'>adb forward tcp:6000 tcp:6000
                            <li class='fragment'>select 'connect' from the 'Web Developer' menu and connect
                        </ul>
                    </section>
                    <section>
                        <h2>jsconsole.com</h2>
                        <p>This site exposes a console for you to work with. However if you type :listen [key] you can then debug remotely any browser that has the script included</p>
                        <img src='jsconsole_listen.png' />
                        <img src='jsconsole_msg_received.png' />

                    </section>
                    <section >
                        <h2>weinre (WEb INspector REmote)</h2>
                        <ul>
                            <li class='fragment'>Runs many remote debuggers
                                <ul>
                                    <li class='fragment'>jsFiddle remote
                                    <li class='fragment'>trigger.io remote debugger
                                    <li class='fragment'>Adobe <del>Shadow</del> Edge Inspect
                                    <li class='fragment'>debug.phonegap.com
                                </ul>
                            </li>
                            <li class='fragment'>Installable locally
                            <li class='fragment'>npm install -g weinre
                        </ul>
                    </section>
                    <section id='weinre'>
                        <h2>Using Weinre</h2>
                        <ul>
                            <li> $ weinre
                            <li> open up the localhost:port
                            <li> get the client url for inspecting
                            <li> enjoy
                         </ul>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Managing iOS URLS</h2>
                        <ul>
                            <li class='fragment'>URLs can become a problem
                            <li class='fragment'>client created links
                            <li class='fragment'>full page images
                            <li class='fragment'>any page without a jQuery Mobile back button
                        </ul>
                    </section>
                    <section>
                        <img src='trap.gif' />
                        <p class='fragment'>Users get trapped</p>
                    </section>
                    <section>
                        <h2>methods of controlling this</h2>
                        <ul>
                            <li class='fragment'>Cordova.plist -> <ul>
                                ExternalHosts
                                <li class='fragment'>each_url.com
                                <li class='fragment'>wildcards *
                                <li class='fragment'>wildcards + code
                                </ul>
                            </li>
                        </ul>

                    </section>
                    <section>
                        <p>In the MainViewController.m file for iOS PhoneGap</p>
                        <pre><code>
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
  NSURL *url = [request URL];
  if ( ([url fragment] != NULL) && 
     ([[url fragment] rangeOfString:@"openExternal=true"].location != NSNotFound) )
  {
    if ([[UIApplication sharedApplication] canOpenURL:url]) {
      [[UIApplication sharedApplication] openURL:url];
      return NO;
    }
  }
  return YES;
}
                        </code></pre>
                    </section>
                    <section>
                        <p>in my jQuery Mobile app</p>
                        <pre><code>
/* turn all target = _blanks into whitelisted urls */
$(document).on("click", function (event) {
    if (event.target.target === "_blank" 
        && event.target.href.indexOf("#openExternal=true") === -1) {
        event.target.href = event.target.href + "#openExternal=true";
    }
});
</code></pre>
                    </section>
                </section>
                <section>
                    <h2>Thanks</h2>
                </section>

            </div>
        </div><script src="lib/js/head.min.js">
</script> <script src="js/reveal.min.js">
</script> <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,
                width: 1024,
                height: 768,
                theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                    // { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
                    //{ src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>
    </body>
</html>
